### 하드웨어 인터럽트 처리 순서

1. 입출력장치는 CPU에 인터럽트 요청 신호를 보냄
2. CPU는 실행 사이클이 끝나고 명령어 인출 전 항상 인터럽트 여부 확인
3. 인터럽트 요청 확인후 인터럽트 플래그를 통해 현재 인터럽트를 받아들일 수 있는지 여부 확인
4. 인터럽트를 받아들일 수 있다면 CPU는 지금까지의 작업을 백업
5. 인터럽트 벡터를 참조하여 인터럽트 서비스 루틴 실행
6. 인터럽트 서비스 루틴 실행이 끝나면 백업해 둔 작업을 복구하여 실행 재개

### 인터럽트 요청 신호

- 지금 끼어들어도 되나요? CPU에게 물어보는 것

### 인터럽트 플래그

- 인터럽트 플래그 : 가능 불가능 설정
  - 인터럽트 플래그가 불가능으로 설정되어 있어도 무시할 수 없는 인터럽트 요청도 있음 -> 하드웨어 고장, 정전으로 인한 인터럽트

### 인터럽트 서비스 루틴

- 인터럽트 핸들러
- 인터럽트를 처리하기 위한 프로그램

### 인터럽트 벡터

- 인터럽트 서비스 루틴을 식별하기 위한 정보
- 인터럽트 서비스 루틴의 시작 주소를 알 수 있음 - 실행에 도움

### 인터럽트 발생 전까지 레지스터에 저장되어 있었던 값들은 어떻게 하나?

- 스택에 백업해둠
- 인터럽트 서비스 루틴의 시작 주소가 위치한 곳으로 프로그램 카운터 값을 갱신하고 인터럽트 서비스 루틴 실행
- 인터럽트 처리 후, 스택에 저장해 둔 값을 다시 불러온 뒤 수ㅜ행하던 작업을 재개

# 예외의 종류

- CPU가 예외를 처리한 후 본래 작업으로 되돌아왔을 때 어디서부터 실행하느냐

### 폴트(fault)

- 예외를 처리한 직후 예외가 발생한 명령어부터 실행을 재개하는 예외
  - CPU 명령어 실행 시, 실행에 필요한 데이터가 보조기억장치에 있어서 메모리로 가져와야 하는 경우, CPU는 폴트를 발생시킴

### 트랩(trap)

- 예외를 처리한 직후 예외가 발생한 명령어의 다음 명령어부터 실행을 재개하는 예외
  - 디버깅할 때 주로 사용

### 중단(abort)

- CPU가 실행중인 프로그램을 강제로 중단시킬 수밖에 없는 심각한 오류를 발견했을 때 발생하는 예외

### 소프트웨어 인터럽트

- 시스템 호출이 발생했을 때 나타남

# 질문

### 소프트웨어 인터럽트와 하드웨어 인터럽트의 차이점은 무엇인가요?

- 하드웨어 인터럽트는 외부 장치(예: 키보드, 마우스, 네트워크 카드 등)에서 발생하는 인터럽트입니다. 반면에 소프트웨어 인터럽트는 프로그램의 특정 명령어에 의해 발생하는 인터럽트입니다. 예를 들어, 시스템 호출(System Call)은 소프트웨어 인터럽트를 유발합니다. 하드웨어 인터럽트는 외부 이벤트에 의해 발생하므로 비동기적으로 발생하는 반면, 소프트웨어 인터럽트는 프로그램의 흐름에 따라 발생합니다

### 예외와 인터럽트의 차이점은? 소프트웨어 인터럽트는 예외라고 볼 수 있나요?

1. 발생 원인
   예외: 예외는 주로 프로그램 내에서 발생하는 오류나 특수한 상황 때문에 발생합니다. 예를 들어, 0으로 나누기, 페이지 폴트, 잘못된 명령어 실행 등 CPU에서 명령어를 실행하는 도중에 발생하는 예외적인 상황이 예외를 유발합니다.
   인터럽트: 인터럽트는 일반적으로 외부 장치(예: 키보드, 마우스, 하드웨어 타이머 등)에서 발생하는 이벤트에 의해 유발됩니다. 예를 들어, 키보드 입력이 들어오거나 타이머가 만료되었을 때 발생합니다.
2. 발생 시점
   예외: 예외는 CPU가 명령어를 실행하는 도중에 발생합니다. 즉, 프로그램의 흐름을 따라가다가 예외 상황이 발생했을 때 발생합니다.
   인터럽트: 인터럽트는 프로그램 실행과는 별개로, 비동기적으로 발생합니다. 외부 장치가 CPU에게 주의를 요청하는 시점에 발생합니다.
3. 처리 방식
   예외: 예외는 예외 핸들러(Exception Handler)에 의해 처리됩니다. 예외가 발생하면 CPU는 현재 명령어의 실행을 중단하고, 해당 예외를 처리하기 위한 코드로 점프합니다.
   인터럽트: 인터럽트는 인터럽트 핸들러(Interrupt Handler)에 의해 처리됩니다. 인터럽트가 발생하면 CPU는 현재 작업을 중단하고 인터럽트 벡터 테이블을 참조하여 해당 인터럽트에 대응하는 핸들러를 실행합니다.
4. 사용 목적
   예외: 예외는 주로 프로그램의 오류 처리나 특수한 조건에 대한 대처를 위해 사용됩니다. 예를 들어, 잘못된 메모리 접근이 발생하면 이를 처리하기 위해 예외가 사용됩니다.
   인터럽트: 인터럽트는 외부 장치의 요구를 즉시 처리하기 위해 사용됩니다. 예를 들어, 입력 장치로부터 데이터를 수신하거나 시스템 타이머에 의해 주기적인 작업을 처리할 때 인터럽트가 사용됩니다.
5. 우선순위
   예외: 예외는 발생한 오류의 심각도에 따라 우선순위가 다를 수 있습니다. 일부 예외는 시스템이 즉시 처리해야 하며, 다른 작업을 중단하고 처리될 수 있습니다.
   인터럽트: 인터럽트는 일반적으로 우선순위에 따라 처리됩니다. 우선순위가 높은 인터럽트는 낮은 우선순위의 인터럽트를 중단하고 처리될 수 있습니다.

- 소프트웨어 인터럽트가 예외로 간주되는 이유:
- 공통된 처리 메커니즘: 소프트웨어 인터럽트와 예외는 둘 다 인터럽트 벡터 테이블을 통해 특정 핸들러로 점프하는 방식으로 처리됩니다. 이 때문에 소프트웨어 인터럽트도 예외와 유사하게 여겨질 수 있습니다.
- CPU의 관점: CPU는 소프트웨어 인터럽트를 처리할 때와 예외를 처리할 때 동일한 메커니즘을 사용합니다. 이로 인해 소프트웨어 인터럽트를 예외의 한 형태로 분류하기도 합니다.

### 인터럽트 우선순위는 무엇이며, 어떻게 관리되나요?

- 하드웨어적으로는 인터럽트 컨트롤러가 우선순위를 관리하며, 소프트웨어적으로는 운영체제가 인터럽트 처리 루틴에서 우선순위를 조정할 수 있습니다.

### 인터럽트 핸들러에서 발생할 수 있는 문제점은 무엇이며, 이를 해결하기 위한 방법은 무엇인가요?

- 인터럽트 핸들러에서 발생할 수 있는 대표적인 문제로는 레이스 컨디션, 교착 상태, 그리고 핸들러의 장시간 실행으로 인한 시스템 성능 저하 등이 있습니다. 레이스 컨디션을 방지하기 위해서는 적절한 동기화 메커니즘을 사용해야 하며, 교착 상태를 피하기 위해서는 자원 할당 순서를 엄격히 관리해야 합니다. 또한, 인터럽트 핸들러는 가능한 짧게 설계하여 장시간 실행으로 인한 성능 저하를 방지하고, 복잡한 작업은 핸들러가 아닌 다른 스레드나 프로세스에서 처리하도록 해야 합니다.
