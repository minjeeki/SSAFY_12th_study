# CPU 스케줄링 (CPU sheduling)

> 프로세스들에게 현명하게 CPU를 배분하지 못하면 반드시 실행되어야 할 프로세스들이 실행되지 못하거나 당장 급하지 않은 프로세스들만 주로 실행될 수도 있따 => 무질서한 상태가 발생할 수도 있음

## 프로세스 우선순위

> 프로세스에게 공정하게 CPU를 배분하기 위해서는 `상황에 맞게`, `프로세스 중요도에 맞게` 프로세스마다 우선순위를 부여해야 한다.

### 입출력 집중 프로세스 vs CPU 집중 프로세스

* CPU 집중 프로세스 (CPU bound process)

    : 대기 상태보다 실행 상태에 더 많이 머무르게 되는 프로세스

    * 입출력 버스트 < CPU 버스트

    * 예. 복잡한 수학 연산, 컴파일, 그래픽 처리 작업 등 담당 프로세스

* 입출력 집중 프로세스 (I/O bound process)

    : 실행 상태보다 입출력을 위한 대기 상태에 더 많이 머무르게 되는 프로세스

    * 입출력 버스트 > CPU 버스트

    * 예. 비디오 재생, 디스크 백업 작업 등 담당 프로세스

* 입출력 버스트와 CPU 버스트

    * CPU 버스트 : CPU를 이용하는 작업

    * 입출력 버스트 : 입출력장치를 기다리는 작업

    > 프로세스는 일반적으로 CPU 버스트와 입출력 버스트를 반복하며 실행한다.

## 스케줄링 큐

: CPU를 사용하고 싶은 프로세스들, 메모리에 적재되고 싶은 프로세스, 특정 입출력 장치를 사용하고 싶은 프로세스들을 줄 세워서 우선순위를 찾을 프로세스를 구분한 것

=> 운영체제는 프로세스가 어떤 일을 하고 싶은지에 따라 (메모리 적재, CPU 이용, 입출력 장치 이용) 큐를 만들고, 각각의 큐에 삽입해 줄을 세운다.

### 운영체제가 관리하는 대표적인 큐

* 준비 큐 (ready queue) : CPU를 이용하고 싶은 준비 상태의 프로세스들이 서는 줄

* 대기 큐 (waiting queue) : 입출력 장치를 이용하기 위해 대기 상태에 접어든 프로세스들이 서는 줄

## 스케줄링 방식 : 선점형과 비선점형 스케줄링

* 선점 : 남보다 앞서서 차지함

### 선점형 스케줄링

: 프로세스가 CPU를 비롯한 자원을 사용하고 있더라도 운영체제가 프로세스로부터 자원을 강제로 빼앗아 다른 프로세스에 할당할 수 있는 스케줄링 방식 (운영체제가 CPU 할당 선택권을 선점함)

* 하나의 프로세스가 자원 사용을 독점할 수 없는 스케줄링 방식

* 장점 : 프로세스들에 골고루 자원을 배분할 수 있음

* 단점 : 문맥 교환이 잦기 때문에 문맥 교환 과정에서 오버 헤드 많이 발생

### 비선점형 스케줄링

: 하나의 프로세스가 자원을 사용하고 있을 경우 해당 프로세스의 종료 또는 스스로 대기 상태에 접어들이 전까지 다른 프로세스가 끼어들 수 없는 스케줄링 방식 (운영체제가 CPU 할당 선택권을 선점하지 못함)

* 하나의 프로세스가 자원 사용을 독점할 수 있는 스케줄링 방식

* 장점 : 문맥 교환에서 발생하는 오버 헤드가 선점형에 비해 드물다

* 단점 : 당장 자원을 사용해야 하는 상황에서도 기다려야 함 => 골고루 자원 사용 불가

## CPU 스케줄링 알고리즘 (아이디어)

### 선입 선처리 스케줄링 (FCFS 스케줄링)

: 큐에 삽입된 순서대로 프로세스들을 처리, 비선점형 스케줄링 (하나의 프로세스가 자원 독점 가능, 운영체제가 주도하지 못함)

=> 먼저 요청한 프로세스부터 CPU를 할당

* 단점 : 프로세스들이 기다리는 시간이 매우 길어질 수 있음 => 호위 효과 (convoy effect)

### 최단 작업 우선 스케줄링 (SJF 스케줄링)

: CPU 사용 시간이 긴 프로세스는 나중에 실행, CPU 사용 시간이 짧은 간단한 프로세스는 먼저 실행하는 스케줄링

* 최단 작업 우선 스케줄링은 기본적으로 비선점형 스케줄링 알고리즘으로 분류되나, 선점형으로 구현될 수도 있음

=> 선점형 최단 작업 우선 스케줄링 (최소 잔여 시간 우선 스케줄링, SRT 스케줄링)

### 라운드 로빈 스케줄링

: 선입 선처리 스케줄링 + 타임 슬라이스 개념 더해진 선점형 스케줄링

=> 정해진 타임 슬라이스만큼의 시간 동안 돌아가며 CPU를 이용

* 타임 슬라이스 : 프로세스가 CPU를 사용할 수 있는 정해진 시간

### 최소 잔여 시간 우선 스케줄링 (SRT 스케줄링)

: 최단 작업 우선 스케줄링 + 라운드 로빈 알고리즘을 합친 스케줄링 알고리즘

=> 최소 잔여 시간 우선 스케줄링에서 타임 슬라이스만큼 CPU를 사용, 다음 프로세스 선정 기준은 작업 시간이 가장 적게 남은 프로세스


### 우선순위 스케줄링

: 프로세스들에 우선순위를 부여하고 가장 높은 우선순위를 가진 프로세스부터 실행하는 스케줄링 알고리즘 (우선 순위가 같을 경우 선입 선처리로 진행)

* 문제점 : 우선순위가 낮은 프로세스는 실행이 계속해서 연기도리 수 있음 => 기아 현상 (starvation)

* 문제점 해결 방안 : 에이징 => 오랫동안 대기 프로세스의 우선순위를 점차 높임

### 다단계 큐 스케줄링

: 우선순위 별로 준비 큐를 여러개 사용하는 스케줄링

* 큐를 여러개 둘 경우 장점

    * 프로세스 유형별로 우선순위를 구분하여 실행하는 것이 편리해짐

    * 큐별 타임 슬라이스 여러개 지정 가능 & 큐마다 다른 스케줄링 알고리즘 사용 가능

### 다단계 피드백 큐 스케줄링

: 다단계 큐 스케줄링의 발전된 형태 (다단계 큐에서 발생할 수 있는 기아 현상 해결)

=> 프로세스들이 큐 사이를 이동할 수 있음