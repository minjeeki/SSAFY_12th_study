# 균형 검색 트리

- 노드의 삽입과 삭제가 일어날 때 균형을 유지하도록 하는 트리
    - AVL트리
    - Red-black 트리
- 이진 탐색 트리의 단점을 극복할 수 있는 자료구조
    - 한쪽으로 치우친 편향 이진 트리가 되면 트리의 높이가 높아지고, 특정 값을 찾아내려면 트리 전체를 탐색해야 하기 때문 → O(N)

---

## AVL트리

- 자가 균형 이진 탐색 트리(스스로 균형을 잡는 데이터 구조, 이진 트리 특성)
- 왼쪽, 오른쪽 서브 트리의 높이 차이가 최대 1
- 어떤 시점에서 높이 차이가 1보다 커지면 회전(rotation)을 통해 균형을 잡아 차이를 줄임
- 높이를 logN으로 유지 → 삽입, 검색, 삭제의 시간 복잡도 : O(logN)

### Balance Factor(BF)

: 균형 인수

- BF = 왼쪽 서브 트리의 높이 - 오른쪽 서브 트리 높이
    - 단말 노드는 서브 트리가 없으므로 BF= 0
- 균형 인수의 절대 값이 클 수록 트리의 균형이 무너진 것
    - BF (+) 이면 왼쪽 서브 트리에 문제가 있는 것
    - BF( - ) 이면 오른쪽 서브 트리에 문제가 있는 것

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/7dec9e0b-3d54-45f5-a846-7f1738a418c3/c512138c-9d55-45c3-95bc-b0e09f96e2c3/Untitled.png)

### **트리 불균형**

- LL problem : Left - Left로 서브 트리가 비대해지는것.
- LR problem : Left - Right로 서브 트리가 비대해지는것.
- RR problem : Right - Right로 서브 트리가 비대해지는것.
- RL problem : Right - Lefe로 서브 트리가 비대해지는것.

### 균형이 깨진 AVL 트리의 수선 - 회전(rotation)

- **LL 회전**
    - 상위 구간을 오른쪽(시계 방향)으로 회전
        
        ![Untitled](https://velog.velcdn.com/images/dnrwhddk1/post/d57c02c8-73ea-49e5-b8a0-bebad7b11d90/image.png)
        

- **RR 회전**
    - 상위 구간을 왼쪽(반시계 방향)으로 회전
        
        ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/7dec9e0b-3d54-45f5-a846-7f1738a418c3/006a7071-6c69-4acd-a447-0ff04459138d/Untitled.png)
        
    
- **LR 회전**
    - 우측 비대 문제 우선 해결
    - 하위 구간을 1차로 RR 회전을 시켜서 LL유형으로 변환한 다음 LL회전 적용
        
        ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/7dec9e0b-3d54-45f5-a846-7f1738a418c3/ad5a08a1-6f02-40b5-843a-e78d000312b3/Untitled.png)
        
    
- **RL 회전**
    - 좌측 비대 문제 우선 해결 (RL 문제는 LR문제를 해결했을 때와 대칭적으로 해결)
    - 하위 구간을 1차로 LL 회전을 시켜서 RR유형으로 변환한 다음 RR회전을 적용
        
        ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/7dec9e0b-3d54-45f5-a846-7f1738a418c3/d2f33001-9700-412d-a218-1c03430ac24f/Untitled.png)
        
    

---

## **Red-Black 트리**

- **자가 균형 이진 탐색 트리**
- 모든 노드는 빨간색 OR 검은색
- 루트 노드, 모든 리프 노드(NIL)들은 검은색
    - (NIL : null leaf, 자료를 갖지 않고 트리의 끝을 나타내는 노드)
- 빨간색 노드의 자식은 검은색
    - No Double Red(빨간색 노드가 연속으로 나올 수 없음)
- 모든 리프 노드에서 Black Depth는 같음
    - 리프노드에서 루트 노드까지 가는 경로에서 만나는 검은색 노드의 개수가 같음
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/7dec9e0b-3d54-45f5-a846-7f1738a418c3/7d89e94e-180b-4ea3-8ad1-1fd1233ab82e/Untitled.png)
    

**레드-블랙 트리 시뮬레이터**

https://www.cs.usfca.edu/~galles/visualization/RedBlack.html

## **B-트리**

- 모든 리프노드들이 같은 레벨을 가질 수 있도록 자동으로 벨런스를 맞추는 트리.
- 정렬된 순서 보장
- 멀티레벨 인덱싱을 통한 빠른 검색
- 모든 리프 노드들이 같은 레벨에 존재
- 이진 트리와 다르게 하나의 노드에 많은 수의 정보를 가짐
    - 노드에는 2개 이상의 데이터(key)가 들어갈 수 있음
- 최대 M개의 자식을 가질 수 있는 B-트리 ⇒ M차 B-트리
- 특정 노드의 데이터(key)가 K개라면, 자식 노드의 개수 : K+1
- 주로 DB에서 사용하는 자료구조

---

### **1. Red-Black 트리**

- 강점
    - 균형 유지: 상대적으로 간단한 규칙으로 균형을 유지하여, 삽입과 삭제가 빠르게 이루어짐.
    - 빠른 삽입/삭제: 평균적으로 O(log n) 시간 복잡도로 삽입 및 삭제가 가능함.
    - 메모리 효율성: 각 노드에 색상 정보를 추가하는 것만으로 균형을 유지하므로 메모리 사용이 효율적임.
- 단점
    - 검색 속도: AVL 트리보다 검색 속도가 느릴 수 있음. 균형이 덜 엄격하므로 트리의 깊이가 더 깊어질 수 있음.구현 복잡성: 삽입 및 삭제 과정에서 색상 변경과 회전이 필요하여 구현이 다소 복잡함.
- 사용 사례
    - 일반적인 데이터 구조 라이브러리에서 사용되며, 특히 삽입과 삭제가 빈번하게 발생하는 경우에 적합함.

---

### **2. B-트리**

- 강점
    - 디스크 I/O 최적화: 노드가 여러 개의 키를 가질 수 있어, 디스크 기반 데이터베이스와 파일 시스템에서 효율적임.높이 제한: B-트리는 균형을 잘 유지하여 트리의 높이가 낮아져 검색과 삽입 성능이 향상됨.
- 단점
    - 구현 복잡성: 노드 분할과 병합 과정이 복잡하여 구현이 어려울 수 있음.메모리 사용: 각 노드가 여러 키를 저장하기 때문에 메모리 사용량이 상대적으로 높을 수 있음.
- 사용 사례
    - 데이터베이스 시스템, 파일 시스템 등 대량의 데이터를 효율적으로 관리해야 하는 경우에 사용됨.

---

### **3. AVL 트리**

- 강점
    - 빠른 검색 성능: 항상 균형을 유지하여 검색 속도가 빠르며, 최악의 경우에도 O(log n) 시간 복잡도를 보장함.엄격한 균형: 높이 차이가 1 이하로 유지되어 깊이가 최소화됨.
- 단점
    - 삽입/삭제에서의 성능 저하: 삽입 및 삭제 과정에서 자주 회전이 발생하여 성능 저하가 있을 수 있음.구현 복잡성: 균형을 유지하기 위해 복잡한 회전 연산이 필요하여 구현이 어려울 수 있음.
- 사용 사례
    - 검색이 빈번하게 발생하고, 데이터의 삽입 및 삭제가 상대적으로 적은 경우에 적합함.

---

### **4. 이진 탐색 트리 (BST)**

- 강점
    - 단순한 구현: 구조가 간단하고 직관적이며, 기본적인 이진 탐색 개념에 기반하여 쉽게 이해할 수 있음.유연한 데이터 구조: 다양한 데이터에 대해 유연하게 사용할 수 있음.
- 단점
    - 불균형 문제: 데이터가 정렬된 순서로 삽입될 경우 최악의 경우 O(n) 성능 저하가 발생할 수 있음.검색 성능 저하: 균형을 유지하지 않기 때문에 검색 성능이 저하될 수 있음.
- 사용 사례
    - 작은 데이터셋을 다루거나, 삽입과 삭제가 적고 검색이 빈번한 경우에 사용됨.

---

### **요약**

이진 탐색 트리: 간단한 구조로 작은 데이터셋에 적합하지만, 불균형 시 성능 저하가 우려됨.

Red-Black 트리: 삽입과 삭제가 빈번한 경우에 적합. 검색 속도가 다소 느릴 수 있음.

B-트리: 디스크 기반의 대량 데이터 처리에 최적화되어 있음.

AVL 트리: 검색 성능이 중요하고 데이터 삽입/삭제가 적은 경우에 유리.