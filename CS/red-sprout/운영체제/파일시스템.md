# 파일과 디렉터리
## 파일
- `파일` : 하드 디스크나 SSD와 같은 보조기억장치에 저장된 관련 정보 집합
- 파일 연산을 위한 시스템 호출들 : 생성, 삭제, 열기, 닫기, 읽기, 쓰기
## 디렉터리
- 파일들을 일목요연하게 관리하기 위한 구조, 정보들을 저장하는 **파일**
- 윈도우 운영체제에서 디렉터리를 폴더라고 부름
- `절대 경로` : 루트 디렉터리에서 자기자신까지 이르는 고유한 경로
- `상대 경로` : 현재 디렉터리에서 시작하는 경로
# 파일 시스템
## 파티셔닝과 포매팅
- `파티셔닝` : 파티션을 나누는 작업, 저장장치의 논리적인 영역을 구획하는 작업
- `포매팅` : 포맷 작업, 파일 시스템을 설정하여 어떤 방식으로 파일을 저장하고 관리할 것인지를 결정하고, 새로운 데이터를 쓸 준비를 하는 작업을 의미
   - `저수준 포매팅` : 저장 장치를 생성할 당시 공장에서 수행되는 물리적인 포매팅
   - `논리적 포매팅` : 파일 시스템을 생성하는 포매팅
## 파일 할당 방법
- `블록` : 운영체제가 파일과 디렉터리를 읽고 쓰는 단위
### 연속 할당(contiguous allocation)
- 보조 기억 장치 내 연속적인 블록에 할당하는 방식
- 할당 파일에 접근하기 위해서는 블록 주소와 블록 단위의 길이만 알면 됨
- 단순하지만, 파일 삭제시 **외부 단편화** 야기
### 불연속 할당
- 연결 할당, 색인 할당
### 연결 할당(linked allocation)
- 각 블록 일부에 다음 블록의 주소를 저장하여 각 블록이 다음 블록 가리키는 형태 - 연결 리스트
- 연결 할당을 사용하는 파일 시스템에서는 디렉터리 엔트리에 연속 할당과 마찬가지로 파일 이름과 함께 첫 번째 블록 주소와 블록 단위의 길이를 명시
- 디렉터리 엔트리(행)만 보아도 어떤 파일이 어디에 저장되어 있는지 알 수 있음
#### 단점
- 연결 리스트 특성상 random access X - 조회 속도 느림
- 하드웨어 고장이나 오류 발생 시 해당 블록 이후 블록은 접근 불가 - **FAT 파일 시스템** 사용
### 색인 할당(indexed allocation)
- 파일의 모든 블록 주소를 **색인 블록** 이라는 하나의 블록에 모아 관리
- 임의의 위치에 접근하기 쉬움
- 색인 할당을 사용하는 파일 시스템에서는 디렉터리 엔트리에 파일 이름과 더불어 색인 블록 주소 명시
## FAT & 유닉스 파일 시스템
### FAT 파일 시스템
- 연결 할당의 단점을 보완한 파일 시스템
- 각 블록에 포함된 다음 블록의 주소를 한 군데 모아서 테이블 형태로 관리 - `파일 할당 테이블(File Allocation Table, FAT)`
- USB 메모리, SD 카드 등에 사용
- FAT(FAT12) 파일 시스템 파티션 도식도
  |예약 영역|FAT 영역|루트 디렉터리 영역|데이터 영역|
  |---|---|---|---|
- 디렉터리들은 다음과 같은 형식으로 블록에 저장
  |파일 이름|확장자|속성|예약 영역|생성 시간|마지막 접근 시간|마지막 수정 시간|시작 블록|파일 크기|
  |---|---|---|---|---|---|---|---|---|
### 유닉스 파일 시스템
- 색인 할당 기반 - 이 때 색인 블록을 `i-node(index-node)`
- i-node에선 파일 속성 정보를 표현
- 파티션
  |예약 영역|i-node 영역|데이터 영역|
  |---|---|---|
- but, i-node 하나는 기본적으로 열다섯개의 블록 주소를 저장 - 그 이상은?
#### 블록 주소 중 열두개는 직접 블록 주소를 저장
- `직접 블록(direct block)` : 파일 데이터가 저장된 블록
#### 충분하지 않다면 열세번째 주소에 단일 간접 블록 주소를 저장
- `단일 간접 블록(single indirect block)` : 파일 데이터를 저장한 블록 주소가 저장된 블록
#### 또 부족하다면 열네번째 주소에 이중 간접 블록 주소를 저장
#### 또또 부족하다면 열다섯번째 주소에 삼중 간접 블록 주소를 저장
----
> GPT의 도움
### NT 파일 시스템(NTFS)
- **개발 배경**: NTFS는 마이크로소프트가 윈도우 NT 계열 운영체제를 위해 개발한 파일 시스템으로, FAT 파일 시스템의 한계를 극복하기 위해 설계됨.
- **주요 특징**:
  - **저널링**: NTFS는 메타데이터에 대한 저널링 기능을 제공하여 시스템 충돌 후 데이터 손상을 방지함. 작업 로그를 통해 시스템 크래시가 발생했을 때 빠르게 복구
  - **파일 및 디렉터리 권한**: 파일과 폴더에 대한 세부적인 권한 설정이 가능함. 사용자는 ACL(Access Control List)을 통해 접근 권한을 관리함.
  - **대용량 파일 및 파티션 지원**: NTFS는 매우 큰 파일(최대 16TB 이상)과 파티션을 지원함.
  - **파일 압축**: 파일 및 폴더 수준에서의 자동 압축 기능을 지원하여 디스크 공간을 절약함.
  - **암호화**: EFS(Encrypting File System)를 통해 파일을 암호화하여 보안을 강화함.
  - **유연한 파일 이름 관리**: 긴 파일 이름과 유니코드를 지원하며, 대소문자를 구분하지 않음.

### ext 파일 시스템
- **개발 배경**: ext 파일 시스템은 리눅스 운영체제를 위해 개발된 파일 시스템으로, 최초의 상용 리눅스 파일 시스템으로서 ext2, ext3, ext4 등 여러 버전이 존재함.
- **주요 특징**:
  - **저널링**: ext3와 ext4는 저널링 기능을 제공하여 데이터 일관성을 유지함.
  - **대용량 파일 및 파티션 지원**: ext4는 최대 16TB의 파일 크기와 1EB의 파일 시스템 크기를 지원함.
  - **백그라운드 파일 시스템 검사**: ext4는 파일 시스템 검사를 백그라운드에서 수행할 수 있어 시스템 가동 시간에 영향을 덜 줌.
  - **빠른 확장**: ext4는 동적 inode 할당 및 빠른 확장 기능을 제공하여 대규모 파일 시스템 관리에 유리함.
  - **호환성**: ext3와 ext4는 이전 버전인 ext2와의 높은 호환성을 유지함.
 
### 면접 질문 1
- **질문**: 파일 시스템의 역할에 대해 설명해 주세요.
- **꼬리 질문**: 파일 시스템이 지원하는 기능 중 중요한 것이 무엇인지 설명해 주실 수 있나요?
- **답변**: 파일 시스템은 데이터를 저장, 관리, 조직화하는 데 사용되며, 파일과 디렉터리 구조를 유지합니다. 중요한 기능 중 하나는 **저널링**으로, 데이터 손실을 방지하고 시스템 복구를 용이하게 합니다.

### 면접 질문 2
- **질문**: NTFS와 ext 파일 시스템의 차이점에 대해 설명해 주세요.
- **꼬리 질문**: NTFS에서의 파일 압축 기능은 ext 파일 시스템에서 어떻게 구현될 수 있을까요?
- **답변**: NTFS는 윈도우에서 사용되는 파일 시스템으로, 저널링, 파일 압축, 암호화 등 다양한 기능을 제공합니다. 반면 ext 파일 시스템은 리눅스에서 사용되며, ext4는 높은 호환성과 대용량 파일 지원이 특징입니다. ext 파일 시스템에서는 파일 압축을 기본적으로 지원하지 않지만, 사용자가 추가적인 도구나 패키지를 통해 압축 기능을 구현할 수 있습니다.

### 면접 질문 3
- **질문**: 연속 할당과 연결 할당의 차이점에 대해 설명해 주세요.
- **꼬리 질문**: 연결 할당 방식이 랜덤 접근에 적합하지 않은 이유는 무엇인가요?
- **답변**: 연속 할당은 파일을 연속된 블록에 할당하는 방식으로, 빠른 접근이 가능하지만 외부 단편화 문제를 야기할 수 있습니다. 연결 할당은 블록들이 논리적으로 연결된 구조를 가지며 외부 단편화를 피할 수 있으나, 연결 리스트 구조로 인해 랜덤 접근 속도가 느립니다.

### 면접 질문 4
- **질문**: FAT 파일 시스템에서 사용되는 파일 할당 테이블(FAT)의 역할을 설명해 주세요.
- **꼬리 질문**: FAT 파일 시스템이 NTFS에 비해 갖는 단점은 무엇인가요?
- **답변**: FAT는 파일의 블록 주소를 저장하여 파일이 저장된 위치를 추적하는 데 사용됩니다. 그러나 FAT는 대용량 파일 관리에 비효율적이며, 파일 압축 및 암호화와 같은 고급 기능이 부족합니다.

### 면접 질문 5
- **질문**: 유닉스 파일 시스템에서 i-node의 역할에 대해 설명해 주세요.
- **꼬리 질문**: i-node가 저장할 수 있는 블록 주소의 수가 제한되어 있을 때, 대용량 파일을 어떻게 관리하나요?
- **답변**: i-node는 파일의 메타데이터와 블록 주소를 저장하는 역할을 합니다. 대용량 파일의 경우, 단일 간접 블록, 이중 간접 블록, 삼중 간접 블록을 사용하여 더 많은 블록 주소를 관리할 수 있습니다.
